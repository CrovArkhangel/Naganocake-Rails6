<h1>ショッピングカート</h1>
<%= link_to "カートを空にする", public_cart_items_delete_all_path(@cart_items), data: {confirm: "カート内の商品をすべて削除します。よろしいですか？"}  %>
<table class = "table">
<thead>
  <th>商品名</th>
  <th>単価(税込)</th>
  <th>数量</th>
  <th>小計</th>
  <th></th>
</thead>

<tbody>
<% @cart_items.each do |cart_item| %>
  <tr>
    <td><%= cart_item.product.name %></td>
    <td><%= cart_item.product.with_tax_price.to_s(:delimited) %></td>
    <td>
      <%= form_with model: [:public, cart_item], local: true, method: :patch do |f| %>
        <%= f.hidden_field :product_id, :value => cart_item.product_id %>
        <%= f.number_field :quantity, min: 1, max:10, id: "quantity_cart"%>
        <%= f.submit "変更" %>
      <% end %>
    </td>
    <td><%= cart_item.subtotal %></td>
    <% @sum +=  cart_item.subtotal %>
    <td><%= link_to "削除する", public_cart_item_path(cart_item.id, cart_item), method: :delete %></td>
  </tr>
<% end %>
</tbody>
</table>
<%= link_to "買い物を続ける", root_path %>
<table>
  <tr>
    <th>合計金額</th>
    <th><%= @sum.to_s(:delimited) %></th>
  </tr>
</table>

<h3>情報入力に進む</h3>
